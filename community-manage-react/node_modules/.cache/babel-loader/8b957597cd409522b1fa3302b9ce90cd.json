{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _typeof3 = require(\"@babel/runtime/helpers/typeof\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getSortData = getSortData;\nexports[\"default\"] = useFilterSorter;\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _extends3 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _typeof2 = _interopRequireDefault(require(\"@babel/runtime/helpers/typeof\"));\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _classnames = _interopRequireDefault(require(\"classnames\"));\n\nvar _CaretDownOutlined = _interopRequireDefault(require(\"@ant-design/icons/CaretDownOutlined\"));\n\nvar _CaretUpOutlined = _interopRequireDefault(require(\"@ant-design/icons/CaretUpOutlined\"));\n\nvar _tooltip = _interopRequireDefault(require(\"../../tooltip\"));\n\nvar _util = require(\"../util\");\n\nfunction _getRequireWildcardCache(nodeInterop) {\n  if (typeof WeakMap !== \"function\") return null;\n  var cacheBabelInterop = new WeakMap();\n  var cacheNodeInterop = new WeakMap();\n  return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) {\n    return nodeInterop ? cacheNodeInterop : cacheBabelInterop;\n  })(nodeInterop);\n}\n\nfunction _interopRequireWildcard(obj, nodeInterop) {\n  if (!nodeInterop && obj && obj.__esModule) {\n    return obj;\n  }\n\n  if (obj === null || _typeof3(obj) !== \"object\" && typeof obj !== \"function\") {\n    return {\n      \"default\": obj\n    };\n  }\n\n  var cache = _getRequireWildcardCache(nodeInterop);\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n  for (var key in obj) {\n    if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n\n  newObj[\"default\"] = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n\nvar ASCEND = 'ascend';\nvar DESCEND = 'descend';\n\nfunction getMultiplePriority(column) {\n  if ((0, _typeof2[\"default\"])(column.sorter) === 'object' && typeof column.sorter.multiple === 'number') {\n    return column.sorter.multiple;\n  }\n\n  return false;\n}\n\nfunction getSortFunction(sorter) {\n  if (typeof sorter === 'function') {\n    return sorter;\n  }\n\n  if (sorter && (0, _typeof2[\"default\"])(sorter) === 'object' && sorter.compare) {\n    return sorter.compare;\n  }\n\n  return false;\n}\n\nfunction nextSortDirection(sortDirections, current) {\n  if (!current) {\n    return sortDirections[0];\n  }\n\n  return sortDirections[sortDirections.indexOf(current) + 1];\n}\n\nfunction collectSortStates(columns, init, pos) {\n  var sortStates = [];\n\n  function pushState(column, columnPos) {\n    sortStates.push({\n      column: column,\n      key: (0, _util.getColumnKey)(column, columnPos),\n      multiplePriority: getMultiplePriority(column),\n      sortOrder: column.sortOrder\n    });\n  }\n\n  (columns || []).forEach(function (column, index) {\n    var columnPos = (0, _util.getColumnPos)(index, pos);\n\n    if (column.children) {\n      if ('sortOrder' in column) {\n        // Controlled\n        pushState(column, columnPos);\n      }\n\n      sortStates = [].concat((0, _toConsumableArray2[\"default\"])(sortStates), (0, _toConsumableArray2[\"default\"])(collectSortStates(column.children, init, columnPos)));\n    } else if (column.sorter) {\n      if ('sortOrder' in column) {\n        // Controlled\n        pushState(column, columnPos);\n      } else if (init && column.defaultSortOrder) {\n        // Default sorter\n        sortStates.push({\n          column: column,\n          key: (0, _util.getColumnKey)(column, columnPos),\n          multiplePriority: getMultiplePriority(column),\n          sortOrder: column.defaultSortOrder\n        });\n      }\n    }\n  });\n  return sortStates;\n}\n\nfunction injectSorter(prefixCls, columns, sorterSates, triggerSorter, defaultSortDirections, tableLocale, tableShowSorterTooltip, pos) {\n  return (columns || []).map(function (column, index) {\n    var columnPos = (0, _util.getColumnPos)(index, pos);\n    var newColumn = column;\n\n    if (newColumn.sorter) {\n      var sortDirections = newColumn.sortDirections || defaultSortDirections;\n      var showSorterTooltip = newColumn.showSorterTooltip === undefined ? tableShowSorterTooltip : newColumn.showSorterTooltip;\n      var columnKey = (0, _util.getColumnKey)(newColumn, columnPos);\n      var sorterState = sorterSates.find(function (_ref) {\n        var key = _ref.key;\n        return key === columnKey;\n      });\n      var sorterOrder = sorterState ? sorterState.sortOrder : null;\n      var nextSortOrder = nextSortDirection(sortDirections, sorterOrder);\n      var upNode = sortDirections.includes(ASCEND) && /*#__PURE__*/React.createElement(_CaretUpOutlined[\"default\"], {\n        className: (0, _classnames[\"default\"])(\"\".concat(prefixCls, \"-column-sorter-up\"), {\n          active: sorterOrder === ASCEND\n        })\n      });\n      var downNode = sortDirections.includes(DESCEND) && /*#__PURE__*/React.createElement(_CaretDownOutlined[\"default\"], {\n        className: (0, _classnames[\"default\"])(\"\".concat(prefixCls, \"-column-sorter-down\"), {\n          active: sorterOrder === DESCEND\n        })\n      });\n\n      var _ref2 = tableLocale || {},\n          cancelSort = _ref2.cancelSort,\n          triggerAsc = _ref2.triggerAsc,\n          triggerDesc = _ref2.triggerDesc;\n\n      var sortTip = cancelSort;\n\n      if (nextSortOrder === DESCEND) {\n        sortTip = triggerDesc;\n      } else if (nextSortOrder === ASCEND) {\n        sortTip = triggerAsc;\n      }\n\n      var tooltipProps = (0, _typeof2[\"default\"])(showSorterTooltip) === 'object' ? showSorterTooltip : {\n        title: sortTip\n      };\n      newColumn = (0, _extends3[\"default\"])((0, _extends3[\"default\"])({}, newColumn), {\n        className: (0, _classnames[\"default\"])(newColumn.className, (0, _defineProperty2[\"default\"])({}, \"\".concat(prefixCls, \"-column-sort\"), sorterOrder)),\n        title: function title(renderProps) {\n          var renderSortTitle = /*#__PURE__*/React.createElement(\"div\", {\n            className: \"\".concat(prefixCls, \"-column-sorters\")\n          }, /*#__PURE__*/React.createElement(\"span\", null, (0, _util.renderColumnTitle)(column.title, renderProps)), /*#__PURE__*/React.createElement(\"span\", {\n            className: (0, _classnames[\"default\"])(\"\".concat(prefixCls, \"-column-sorter\"), (0, _defineProperty2[\"default\"])({}, \"\".concat(prefixCls, \"-column-sorter-full\"), !!(upNode && downNode)))\n          }, /*#__PURE__*/React.createElement(\"span\", {\n            className: \"\".concat(prefixCls, \"-column-sorter-inner\")\n          }, upNode, downNode)));\n          return showSorterTooltip ? /*#__PURE__*/React.createElement(_tooltip[\"default\"], tooltipProps, /*#__PURE__*/React.createElement(\"div\", {\n            className: \"\".concat(prefixCls, \"-column-sorters-with-tooltip\")\n          }, renderSortTitle)) : renderSortTitle;\n        },\n        onHeaderCell: function onHeaderCell(col) {\n          var cell = column.onHeaderCell && column.onHeaderCell(col) || {};\n          var originOnClick = cell.onClick;\n\n          cell.onClick = function (event) {\n            triggerSorter({\n              column: column,\n              key: columnKey,\n              sortOrder: nextSortOrder,\n              multiplePriority: getMultiplePriority(column)\n            });\n\n            if (originOnClick) {\n              originOnClick(event);\n            }\n          };\n\n          cell.className = (0, _classnames[\"default\"])(cell.className, \"\".concat(prefixCls, \"-column-has-sorters\"));\n          return cell;\n        }\n      });\n    }\n\n    if ('children' in newColumn) {\n      newColumn = (0, _extends3[\"default\"])((0, _extends3[\"default\"])({}, newColumn), {\n        children: injectSorter(prefixCls, newColumn.children, sorterSates, triggerSorter, defaultSortDirections, tableLocale, tableShowSorterTooltip, columnPos)\n      });\n    }\n\n    return newColumn;\n  });\n}\n\nfunction stateToInfo(sorterStates) {\n  var column = sorterStates.column,\n      sortOrder = sorterStates.sortOrder;\n  return {\n    column: column,\n    order: sortOrder,\n    field: column.dataIndex,\n    columnKey: column.key\n  };\n}\n\nfunction generateSorterInfo(sorterStates) {\n  var list = sorterStates.filter(function (_ref3) {\n    var sortOrder = _ref3.sortOrder;\n    return sortOrder;\n  }).map(stateToInfo); // =========== Legacy compatible support ===========\n  // https://github.com/ant-design/ant-design/pull/19226\n\n  if (list.length === 0 && sorterStates.length) {\n    return (0, _extends3[\"default\"])((0, _extends3[\"default\"])({}, stateToInfo(sorterStates[sorterStates.length - 1])), {\n      column: undefined\n    });\n  }\n\n  if (list.length <= 1) {\n    return list[0] || {};\n  }\n\n  return list;\n}\n\nfunction getSortData(data, sortStates, childrenColumnName) {\n  var innerSorterStates = sortStates.slice().sort(function (a, b) {\n    return b.multiplePriority - a.multiplePriority;\n  });\n  var cloneData = data.slice();\n  var runningSorters = innerSorterStates.filter(function (_ref4) {\n    var sorter = _ref4.column.sorter,\n        sortOrder = _ref4.sortOrder;\n    return getSortFunction(sorter) && sortOrder;\n  }); // Skip if no sorter needed\n\n  if (!runningSorters.length) {\n    return cloneData;\n  }\n\n  return cloneData.sort(function (record1, record2) {\n    for (var i = 0; i < runningSorters.length; i += 1) {\n      var sorterState = runningSorters[i];\n      var sorter = sorterState.column.sorter,\n          sortOrder = sorterState.sortOrder;\n      var compareFn = getSortFunction(sorter);\n\n      if (compareFn && sortOrder) {\n        var compareResult = compareFn(record1, record2, sortOrder);\n\n        if (compareResult !== 0) {\n          return sortOrder === ASCEND ? compareResult : -compareResult;\n        }\n      }\n    }\n\n    return 0;\n  }).map(function (record) {\n    var subRecords = record[childrenColumnName];\n\n    if (subRecords) {\n      return (0, _extends3[\"default\"])((0, _extends3[\"default\"])({}, record), (0, _defineProperty2[\"default\"])({}, childrenColumnName, getSortData(subRecords, sortStates, childrenColumnName)));\n    }\n\n    return record;\n  });\n}\n\nfunction useFilterSorter(_ref5) {\n  var prefixCls = _ref5.prefixCls,\n      mergedColumns = _ref5.mergedColumns,\n      onSorterChange = _ref5.onSorterChange,\n      sortDirections = _ref5.sortDirections,\n      tableLocale = _ref5.tableLocale,\n      showSorterTooltip = _ref5.showSorterTooltip;\n\n  var _React$useState = React.useState(collectSortStates(mergedColumns, true)),\n      _React$useState2 = (0, _slicedToArray2[\"default\"])(_React$useState, 2),\n      sortStates = _React$useState2[0],\n      setSortStates = _React$useState2[1];\n\n  var mergedSorterStates = React.useMemo(function () {\n    var validate = true;\n    var collectedStates = collectSortStates(mergedColumns, false); // Return if not controlled\n\n    if (!collectedStates.length) {\n      return sortStates;\n    }\n\n    var validateStates = [];\n\n    function patchStates(state) {\n      if (validate) {\n        validateStates.push(state);\n      } else {\n        validateStates.push((0, _extends3[\"default\"])((0, _extends3[\"default\"])({}, state), {\n          sortOrder: null\n        }));\n      }\n    }\n\n    var multipleMode = null;\n    collectedStates.forEach(function (state) {\n      if (multipleMode === null) {\n        patchStates(state);\n\n        if (state.sortOrder) {\n          if (state.multiplePriority === false) {\n            validate = false;\n          } else {\n            multipleMode = true;\n          }\n        }\n      } else if (multipleMode && state.multiplePriority !== false) {\n        patchStates(state);\n      } else {\n        validate = false;\n        patchStates(state);\n      }\n    });\n    return validateStates;\n  }, [mergedColumns, sortStates]); // Get render columns title required props\n\n  var columnTitleSorterProps = React.useMemo(function () {\n    var sortColumns = mergedSorterStates.map(function (_ref6) {\n      var column = _ref6.column,\n          sortOrder = _ref6.sortOrder;\n      return {\n        column: column,\n        order: sortOrder\n      };\n    });\n    return {\n      sortColumns: sortColumns,\n      // Legacy\n      sortColumn: sortColumns[0] && sortColumns[0].column,\n      sortOrder: sortColumns[0] && sortColumns[0].order\n    };\n  }, [mergedSorterStates]);\n\n  function triggerSorter(sortState) {\n    var newSorterStates;\n\n    if (sortState.multiplePriority === false || !mergedSorterStates.length || mergedSorterStates[0].multiplePriority === false) {\n      newSorterStates = [sortState];\n    } else {\n      newSorterStates = [].concat((0, _toConsumableArray2[\"default\"])(mergedSorterStates.filter(function (_ref7) {\n        var key = _ref7.key;\n        return key !== sortState.key;\n      })), [sortState]);\n    }\n\n    setSortStates(newSorterStates);\n    onSorterChange(generateSorterInfo(newSorterStates), newSorterStates);\n  }\n\n  var transformColumns = function transformColumns(innerColumns) {\n    return injectSorter(prefixCls, innerColumns, mergedSorterStates, triggerSorter, sortDirections, tableLocale, showSorterTooltip);\n  };\n\n  var getSorters = function getSorters() {\n    return generateSorterInfo(mergedSorterStates);\n  };\n\n  return [transformColumns, mergedSorterStates, columnTitleSorterProps, getSorters];\n}","map":{"version":3,"sources":["D:/IDEA workspace/ZUA/community-manage-react/node_modules/antd/lib/table/hooks/useSorter.js"],"names":["_interopRequireDefault","require","_typeof3","Object","defineProperty","exports","value","getSortData","useFilterSorter","_slicedToArray2","_defineProperty2","_extends3","_toConsumableArray2","_typeof2","React","_interopRequireWildcard","_classnames","_CaretDownOutlined","_CaretUpOutlined","_tooltip","_util","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","cache","has","get","newObj","hasPropertyDescriptor","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","ASCEND","DESCEND","getMultiplePriority","column","sorter","multiple","getSortFunction","compare","nextSortDirection","sortDirections","current","indexOf","collectSortStates","columns","init","pos","sortStates","pushState","columnPos","push","getColumnKey","multiplePriority","sortOrder","forEach","index","getColumnPos","children","concat","defaultSortOrder","injectSorter","prefixCls","sorterSates","triggerSorter","defaultSortDirections","tableLocale","tableShowSorterTooltip","map","newColumn","showSorterTooltip","undefined","columnKey","sorterState","find","_ref","sorterOrder","nextSortOrder","upNode","includes","createElement","className","active","downNode","_ref2","cancelSort","triggerAsc","triggerDesc","sortTip","tooltipProps","title","renderProps","renderSortTitle","renderColumnTitle","onHeaderCell","col","cell","originOnClick","onClick","event","stateToInfo","sorterStates","order","field","dataIndex","generateSorterInfo","list","filter","_ref3","length","data","childrenColumnName","innerSorterStates","slice","sort","a","b","cloneData","runningSorters","_ref4","record1","record2","i","compareFn","compareResult","record","subRecords","_ref5","mergedColumns","onSorterChange","_React$useState","useState","_React$useState2","setSortStates","mergedSorterStates","useMemo","validate","collectedStates","validateStates","patchStates","state","multipleMode","columnTitleSorterProps","sortColumns","_ref6","sortColumn","sortState","newSorterStates","_ref7","transformColumns","innerColumns","getSorters"],"mappings":"AAAA;;AAEA,IAAIA,sBAAsB,GAAGC,OAAO,CAAC,8CAAD,CAApC;;AAEA,IAAIC,QAAQ,GAAGD,OAAO,CAAC,+BAAD,CAAtB;;AAEAE,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAC3CC,EAAAA,KAAK,EAAE;AADoC,CAA7C;AAGAD,OAAO,CAACE,WAAR,GAAsBA,WAAtB;AACAF,OAAO,CAAC,SAAD,CAAP,GAAqBG,eAArB;;AAEA,IAAIC,eAAe,GAAGT,sBAAsB,CAACC,OAAO,CAAC,sCAAD,CAAR,CAA5C;;AAEA,IAAIS,gBAAgB,GAAGV,sBAAsB,CAACC,OAAO,CAAC,uCAAD,CAAR,CAA7C;;AAEA,IAAIU,SAAS,GAAGX,sBAAsB,CAACC,OAAO,CAAC,gCAAD,CAAR,CAAtC;;AAEA,IAAIW,mBAAmB,GAAGZ,sBAAsB,CAACC,OAAO,CAAC,0CAAD,CAAR,CAAhD;;AAEA,IAAIY,QAAQ,GAAGb,sBAAsB,CAACC,OAAO,CAAC,+BAAD,CAAR,CAArC;;AAEA,IAAIa,KAAK,GAAGC,uBAAuB,CAACd,OAAO,CAAC,OAAD,CAAR,CAAnC;;AAEA,IAAIe,WAAW,GAAGhB,sBAAsB,CAACC,OAAO,CAAC,YAAD,CAAR,CAAxC;;AAEA,IAAIgB,kBAAkB,GAAGjB,sBAAsB,CAACC,OAAO,CAAC,qCAAD,CAAR,CAA/C;;AAEA,IAAIiB,gBAAgB,GAAGlB,sBAAsB,CAACC,OAAO,CAAC,mCAAD,CAAR,CAA7C;;AAEA,IAAIkB,QAAQ,GAAGnB,sBAAsB,CAACC,OAAO,CAAC,eAAD,CAAR,CAArC;;AAEA,IAAImB,KAAK,GAAGnB,OAAO,CAAC,SAAD,CAAnB;;AAEA,SAASoB,wBAAT,CAAkCC,WAAlC,EAA+C;AAAE,MAAI,OAAOC,OAAP,KAAmB,UAAvB,EAAmC,OAAO,IAAP;AAAa,MAAIC,iBAAiB,GAAG,IAAID,OAAJ,EAAxB;AAAuC,MAAIE,gBAAgB,GAAG,IAAIF,OAAJ,EAAvB;AAAsC,SAAO,CAACF,wBAAwB,GAAG,SAASA,wBAAT,CAAkCC,WAAlC,EAA+C;AAAE,WAAOA,WAAW,GAAGG,gBAAH,GAAsBD,iBAAxC;AAA4D,GAAzI,EAA2IF,WAA3I,CAAP;AAAiK;;AAE/U,SAASP,uBAAT,CAAiCW,GAAjC,EAAsCJ,WAAtC,EAAmD;AAAE,MAAI,CAACA,WAAD,IAAgBI,GAAhB,IAAuBA,GAAG,CAACC,UAA/B,EAA2C;AAAE,WAAOD,GAAP;AAAa;;AAAC,MAAIA,GAAG,KAAK,IAAR,IAAgBxB,QAAQ,CAACwB,GAAD,CAAR,KAAkB,QAAlB,IAA8B,OAAOA,GAAP,KAAe,UAAjE,EAA6E;AAAE,WAAO;AAAE,iBAAWA;AAAb,KAAP;AAA4B;;AAAC,MAAIE,KAAK,GAAGP,wBAAwB,CAACC,WAAD,CAApC;;AAAmD,MAAIM,KAAK,IAAIA,KAAK,CAACC,GAAN,CAAUH,GAAV,CAAb,EAA6B;AAAE,WAAOE,KAAK,CAACE,GAAN,CAAUJ,GAAV,CAAP;AAAwB;;AAAC,MAAIK,MAAM,GAAG,EAAb;AAAiB,MAAIC,qBAAqB,GAAG7B,MAAM,CAACC,cAAP,IAAyBD,MAAM,CAAC8B,wBAA5D;;AAAsF,OAAK,IAAIC,GAAT,IAAgBR,GAAhB,EAAqB;AAAE,QAAIQ,GAAG,KAAK,SAAR,IAAqB/B,MAAM,CAACgC,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCX,GAArC,EAA0CQ,GAA1C,CAAzB,EAAyE;AAAE,UAAII,IAAI,GAAGN,qBAAqB,GAAG7B,MAAM,CAAC8B,wBAAP,CAAgCP,GAAhC,EAAqCQ,GAArC,CAAH,GAA+C,IAA/E;;AAAqF,UAAII,IAAI,KAAKA,IAAI,CAACR,GAAL,IAAYQ,IAAI,CAACC,GAAtB,CAAR,EAAoC;AAAEpC,QAAAA,MAAM,CAACC,cAAP,CAAsB2B,MAAtB,EAA8BG,GAA9B,EAAmCI,IAAnC;AAA2C,OAAjF,MAAuF;AAAEP,QAAAA,MAAM,CAACG,GAAD,CAAN,GAAcR,GAAG,CAACQ,GAAD,CAAjB;AAAyB;AAAE;AAAE;;AAACH,EAAAA,MAAM,CAAC,SAAD,CAAN,GAAoBL,GAApB;;AAAyB,MAAIE,KAAJ,EAAW;AAAEA,IAAAA,KAAK,CAACW,GAAN,CAAUb,GAAV,EAAeK,MAAf;AAAyB;;AAAC,SAAOA,MAAP;AAAgB;;AAE5yB,IAAIS,MAAM,GAAG,QAAb;AACA,IAAIC,OAAO,GAAG,SAAd;;AAEA,SAASC,mBAAT,CAA6BC,MAA7B,EAAqC;AACnC,MAAI,CAAC,GAAG9B,QAAQ,CAAC,SAAD,CAAZ,EAAyB8B,MAAM,CAACC,MAAhC,MAA4C,QAA5C,IAAwD,OAAOD,MAAM,CAACC,MAAP,CAAcC,QAArB,KAAkC,QAA9F,EAAwG;AACtG,WAAOF,MAAM,CAACC,MAAP,CAAcC,QAArB;AACD;;AAED,SAAO,KAAP;AACD;;AAED,SAASC,eAAT,CAAyBF,MAAzB,EAAiC;AAC/B,MAAI,OAAOA,MAAP,KAAkB,UAAtB,EAAkC;AAChC,WAAOA,MAAP;AACD;;AAED,MAAIA,MAAM,IAAI,CAAC,GAAG/B,QAAQ,CAAC,SAAD,CAAZ,EAAyB+B,MAAzB,MAAqC,QAA/C,IAA2DA,MAAM,CAACG,OAAtE,EAA+E;AAC7E,WAAOH,MAAM,CAACG,OAAd;AACD;;AAED,SAAO,KAAP;AACD;;AAED,SAASC,iBAAT,CAA2BC,cAA3B,EAA2CC,OAA3C,EAAoD;AAClD,MAAI,CAACA,OAAL,EAAc;AACZ,WAAOD,cAAc,CAAC,CAAD,CAArB;AACD;;AAED,SAAOA,cAAc,CAACA,cAAc,CAACE,OAAf,CAAuBD,OAAvB,IAAkC,CAAnC,CAArB;AACD;;AAED,SAASE,iBAAT,CAA2BC,OAA3B,EAAoCC,IAApC,EAA0CC,GAA1C,EAA+C;AAC7C,MAAIC,UAAU,GAAG,EAAjB;;AAEA,WAASC,SAAT,CAAmBd,MAAnB,EAA2Be,SAA3B,EAAsC;AACpCF,IAAAA,UAAU,CAACG,IAAX,CAAgB;AACdhB,MAAAA,MAAM,EAAEA,MADM;AAEdT,MAAAA,GAAG,EAAE,CAAC,GAAGd,KAAK,CAACwC,YAAV,EAAwBjB,MAAxB,EAAgCe,SAAhC,CAFS;AAGdG,MAAAA,gBAAgB,EAAEnB,mBAAmB,CAACC,MAAD,CAHvB;AAIdmB,MAAAA,SAAS,EAAEnB,MAAM,CAACmB;AAJJ,KAAhB;AAMD;;AAED,GAACT,OAAO,IAAI,EAAZ,EAAgBU,OAAhB,CAAwB,UAAUpB,MAAV,EAAkBqB,KAAlB,EAAyB;AAC/C,QAAIN,SAAS,GAAG,CAAC,GAAGtC,KAAK,CAAC6C,YAAV,EAAwBD,KAAxB,EAA+BT,GAA/B,CAAhB;;AAEA,QAAIZ,MAAM,CAACuB,QAAX,EAAqB;AACnB,UAAI,eAAevB,MAAnB,EAA2B;AACzB;AACAc,QAAAA,SAAS,CAACd,MAAD,EAASe,SAAT,CAAT;AACD;;AAEDF,MAAAA,UAAU,GAAG,GAAGW,MAAH,CAAU,CAAC,GAAGvD,mBAAmB,CAAC,SAAD,CAAvB,EAAoC4C,UAApC,CAAV,EAA2D,CAAC,GAAG5C,mBAAmB,CAAC,SAAD,CAAvB,EAAoCwC,iBAAiB,CAACT,MAAM,CAACuB,QAAR,EAAkBZ,IAAlB,EAAwBI,SAAxB,CAArD,CAA3D,CAAb;AACD,KAPD,MAOO,IAAIf,MAAM,CAACC,MAAX,EAAmB;AACxB,UAAI,eAAeD,MAAnB,EAA2B;AACzB;AACAc,QAAAA,SAAS,CAACd,MAAD,EAASe,SAAT,CAAT;AACD,OAHD,MAGO,IAAIJ,IAAI,IAAIX,MAAM,CAACyB,gBAAnB,EAAqC;AAC1C;AACAZ,QAAAA,UAAU,CAACG,IAAX,CAAgB;AACdhB,UAAAA,MAAM,EAAEA,MADM;AAEdT,UAAAA,GAAG,EAAE,CAAC,GAAGd,KAAK,CAACwC,YAAV,EAAwBjB,MAAxB,EAAgCe,SAAhC,CAFS;AAGdG,UAAAA,gBAAgB,EAAEnB,mBAAmB,CAACC,MAAD,CAHvB;AAIdmB,UAAAA,SAAS,EAAEnB,MAAM,CAACyB;AAJJ,SAAhB;AAMD;AACF;AACF,GAxBD;AAyBA,SAAOZ,UAAP;AACD;;AAED,SAASa,YAAT,CAAsBC,SAAtB,EAAiCjB,OAAjC,EAA0CkB,WAA1C,EAAuDC,aAAvD,EAAsEC,qBAAtE,EAA6FC,WAA7F,EAA0GC,sBAA1G,EAAkIpB,GAAlI,EAAuI;AACrI,SAAO,CAACF,OAAO,IAAI,EAAZ,EAAgBuB,GAAhB,CAAoB,UAAUjC,MAAV,EAAkBqB,KAAlB,EAAyB;AAClD,QAAIN,SAAS,GAAG,CAAC,GAAGtC,KAAK,CAAC6C,YAAV,EAAwBD,KAAxB,EAA+BT,GAA/B,CAAhB;AACA,QAAIsB,SAAS,GAAGlC,MAAhB;;AAEA,QAAIkC,SAAS,CAACjC,MAAd,EAAsB;AACpB,UAAIK,cAAc,GAAG4B,SAAS,CAAC5B,cAAV,IAA4BwB,qBAAjD;AACA,UAAIK,iBAAiB,GAAGD,SAAS,CAACC,iBAAV,KAAgCC,SAAhC,GAA4CJ,sBAA5C,GAAqEE,SAAS,CAACC,iBAAvG;AACA,UAAIE,SAAS,GAAG,CAAC,GAAG5D,KAAK,CAACwC,YAAV,EAAwBiB,SAAxB,EAAmCnB,SAAnC,CAAhB;AACA,UAAIuB,WAAW,GAAGV,WAAW,CAACW,IAAZ,CAAiB,UAAUC,IAAV,EAAgB;AACjD,YAAIjD,GAAG,GAAGiD,IAAI,CAACjD,GAAf;AACA,eAAOA,GAAG,KAAK8C,SAAf;AACD,OAHiB,CAAlB;AAIA,UAAII,WAAW,GAAGH,WAAW,GAAGA,WAAW,CAACnB,SAAf,GAA2B,IAAxD;AACA,UAAIuB,aAAa,GAAGrC,iBAAiB,CAACC,cAAD,EAAiBmC,WAAjB,CAArC;AACA,UAAIE,MAAM,GAAGrC,cAAc,CAACsC,QAAf,CAAwB/C,MAAxB,KAAmC,aAAa1B,KAAK,CAAC0E,aAAN,CAAoBtE,gBAAgB,CAAC,SAAD,CAApC,EAAiD;AAC5GuE,QAAAA,SAAS,EAAE,CAAC,GAAGzE,WAAW,CAAC,SAAD,CAAf,EAA4B,GAAGmD,MAAH,CAAUG,SAAV,EAAqB,mBAArB,CAA5B,EAAuE;AAChFoB,UAAAA,MAAM,EAAEN,WAAW,KAAK5C;AADwD,SAAvE;AADiG,OAAjD,CAA7D;AAKA,UAAImD,QAAQ,GAAG1C,cAAc,CAACsC,QAAf,CAAwB9C,OAAxB,KAAoC,aAAa3B,KAAK,CAAC0E,aAAN,CAAoBvE,kBAAkB,CAAC,SAAD,CAAtC,EAAmD;AACjHwE,QAAAA,SAAS,EAAE,CAAC,GAAGzE,WAAW,CAAC,SAAD,CAAf,EAA4B,GAAGmD,MAAH,CAAUG,SAAV,EAAqB,qBAArB,CAA5B,EAAyE;AAClFoB,UAAAA,MAAM,EAAEN,WAAW,KAAK3C;AAD0D,SAAzE;AADsG,OAAnD,CAAhE;;AAMA,UAAImD,KAAK,GAAGlB,WAAW,IAAI,EAA3B;AAAA,UACImB,UAAU,GAAGD,KAAK,CAACC,UADvB;AAAA,UAEIC,UAAU,GAAGF,KAAK,CAACE,UAFvB;AAAA,UAGIC,WAAW,GAAGH,KAAK,CAACG,WAHxB;;AAKA,UAAIC,OAAO,GAAGH,UAAd;;AAEA,UAAIR,aAAa,KAAK5C,OAAtB,EAA+B;AAC7BuD,QAAAA,OAAO,GAAGD,WAAV;AACD,OAFD,MAEO,IAAIV,aAAa,KAAK7C,MAAtB,EAA8B;AACnCwD,QAAAA,OAAO,GAAGF,UAAV;AACD;;AAED,UAAIG,YAAY,GAAG,CAAC,GAAGpF,QAAQ,CAAC,SAAD,CAAZ,EAAyBiE,iBAAzB,MAAgD,QAAhD,GAA2DA,iBAA3D,GAA+E;AAChGoB,QAAAA,KAAK,EAAEF;AADyF,OAAlG;AAGAnB,MAAAA,SAAS,GAAG,CAAC,GAAGlE,SAAS,CAAC,SAAD,CAAb,EAA0B,CAAC,GAAGA,SAAS,CAAC,SAAD,CAAb,EAA0B,EAA1B,EAA8BkE,SAA9B,CAA1B,EAAoE;AAC9EY,QAAAA,SAAS,EAAE,CAAC,GAAGzE,WAAW,CAAC,SAAD,CAAf,EAA4B6D,SAAS,CAACY,SAAtC,EAAiD,CAAC,GAAG/E,gBAAgB,CAAC,SAAD,CAApB,EAAiC,EAAjC,EAAqC,GAAGyD,MAAH,CAAUG,SAAV,EAAqB,cAArB,CAArC,EAA2Ec,WAA3E,CAAjD,CADmE;AAE9Ec,QAAAA,KAAK,EAAE,SAASA,KAAT,CAAeC,WAAf,EAA4B;AACjC,cAAIC,eAAe,GAAG,aAAatF,KAAK,CAAC0E,aAAN,CAAoB,KAApB,EAA2B;AAC5DC,YAAAA,SAAS,EAAE,GAAGtB,MAAH,CAAUG,SAAV,EAAqB,iBAArB;AADiD,WAA3B,EAEhC,aAAaxD,KAAK,CAAC0E,aAAN,CAAoB,MAApB,EAA4B,IAA5B,EAAkC,CAAC,GAAGpE,KAAK,CAACiF,iBAAV,EAA6B1D,MAAM,CAACuD,KAApC,EAA2CC,WAA3C,CAAlC,CAFmB,EAEyE,aAAarF,KAAK,CAAC0E,aAAN,CAAoB,MAApB,EAA4B;AACnJC,YAAAA,SAAS,EAAE,CAAC,GAAGzE,WAAW,CAAC,SAAD,CAAf,EAA4B,GAAGmD,MAAH,CAAUG,SAAV,EAAqB,gBAArB,CAA5B,EAAoE,CAAC,GAAG5D,gBAAgB,CAAC,SAAD,CAApB,EAAiC,EAAjC,EAAqC,GAAGyD,MAAH,CAAUG,SAAV,EAAqB,qBAArB,CAArC,EAAkF,CAAC,EAAEgB,MAAM,IAAIK,QAAZ,CAAnF,CAApE;AADwI,WAA5B,EAEtH,aAAa7E,KAAK,CAAC0E,aAAN,CAAoB,MAApB,EAA4B;AAC1CC,YAAAA,SAAS,EAAE,GAAGtB,MAAH,CAAUG,SAAV,EAAqB,sBAArB;AAD+B,WAA5B,EAEbgB,MAFa,EAELK,QAFK,CAFyG,CAFtF,CAAnC;AAOA,iBAAOb,iBAAiB,GAAG,aAAahE,KAAK,CAAC0E,aAAN,CAAoBrE,QAAQ,CAAC,SAAD,CAA5B,EAAyC8E,YAAzC,EAAuD,aAAanF,KAAK,CAAC0E,aAAN,CAAoB,KAApB,EAA2B;AACrIC,YAAAA,SAAS,EAAE,GAAGtB,MAAH,CAAUG,SAAV,EAAqB,8BAArB;AAD0H,WAA3B,EAEzG8B,eAFyG,CAApE,CAAhB,GAEDA,eAFvB;AAGD,SAb6E;AAc9EE,QAAAA,YAAY,EAAE,SAASA,YAAT,CAAsBC,GAAtB,EAA2B;AACvC,cAAIC,IAAI,GAAG7D,MAAM,CAAC2D,YAAP,IAAuB3D,MAAM,CAAC2D,YAAP,CAAoBC,GAApB,CAAvB,IAAmD,EAA9D;AACA,cAAIE,aAAa,GAAGD,IAAI,CAACE,OAAzB;;AAEAF,UAAAA,IAAI,CAACE,OAAL,GAAe,UAAUC,KAAV,EAAiB;AAC9BnC,YAAAA,aAAa,CAAC;AACZ7B,cAAAA,MAAM,EAAEA,MADI;AAEZT,cAAAA,GAAG,EAAE8C,SAFO;AAGZlB,cAAAA,SAAS,EAAEuB,aAHC;AAIZxB,cAAAA,gBAAgB,EAAEnB,mBAAmB,CAACC,MAAD;AAJzB,aAAD,CAAb;;AAOA,gBAAI8D,aAAJ,EAAmB;AACjBA,cAAAA,aAAa,CAACE,KAAD,CAAb;AACD;AACF,WAXD;;AAaAH,UAAAA,IAAI,CAACf,SAAL,GAAiB,CAAC,GAAGzE,WAAW,CAAC,SAAD,CAAf,EAA4BwF,IAAI,CAACf,SAAjC,EAA4C,GAAGtB,MAAH,CAAUG,SAAV,EAAqB,qBAArB,CAA5C,CAAjB;AACA,iBAAOkC,IAAP;AACD;AAjC6E,OAApE,CAAZ;AAmCD;;AAED,QAAI,cAAc3B,SAAlB,EAA6B;AAC3BA,MAAAA,SAAS,GAAG,CAAC,GAAGlE,SAAS,CAAC,SAAD,CAAb,EAA0B,CAAC,GAAGA,SAAS,CAAC,SAAD,CAAb,EAA0B,EAA1B,EAA8BkE,SAA9B,CAA1B,EAAoE;AAC9EX,QAAAA,QAAQ,EAAEG,YAAY,CAACC,SAAD,EAAYO,SAAS,CAACX,QAAtB,EAAgCK,WAAhC,EAA6CC,aAA7C,EAA4DC,qBAA5D,EAAmFC,WAAnF,EAAgGC,sBAAhG,EAAwHjB,SAAxH;AADwD,OAApE,CAAZ;AAGD;;AAED,WAAOmB,SAAP;AACD,GArFM,CAAP;AAsFD;;AAED,SAAS+B,WAAT,CAAqBC,YAArB,EAAmC;AACjC,MAAIlE,MAAM,GAAGkE,YAAY,CAAClE,MAA1B;AAAA,MACImB,SAAS,GAAG+C,YAAY,CAAC/C,SAD7B;AAEA,SAAO;AACLnB,IAAAA,MAAM,EAAEA,MADH;AAELmE,IAAAA,KAAK,EAAEhD,SAFF;AAGLiD,IAAAA,KAAK,EAAEpE,MAAM,CAACqE,SAHT;AAILhC,IAAAA,SAAS,EAAErC,MAAM,CAACT;AAJb,GAAP;AAMD;;AAED,SAAS+E,kBAAT,CAA4BJ,YAA5B,EAA0C;AACxC,MAAIK,IAAI,GAAGL,YAAY,CAACM,MAAb,CAAoB,UAAUC,KAAV,EAAiB;AAC9C,QAAItD,SAAS,GAAGsD,KAAK,CAACtD,SAAtB;AACA,WAAOA,SAAP;AACD,GAHU,EAGRc,GAHQ,CAGJgC,WAHI,CAAX,CADwC,CAInB;AACrB;;AAEA,MAAIM,IAAI,CAACG,MAAL,KAAgB,CAAhB,IAAqBR,YAAY,CAACQ,MAAtC,EAA8C;AAC5C,WAAO,CAAC,GAAG1G,SAAS,CAAC,SAAD,CAAb,EAA0B,CAAC,GAAGA,SAAS,CAAC,SAAD,CAAb,EAA0B,EAA1B,EAA8BiG,WAAW,CAACC,YAAY,CAACA,YAAY,CAACQ,MAAb,GAAsB,CAAvB,CAAb,CAAzC,CAA1B,EAA6G;AAClH1E,MAAAA,MAAM,EAAEoC;AAD0G,KAA7G,CAAP;AAGD;;AAED,MAAImC,IAAI,CAACG,MAAL,IAAe,CAAnB,EAAsB;AACpB,WAAOH,IAAI,CAAC,CAAD,CAAJ,IAAW,EAAlB;AACD;;AAED,SAAOA,IAAP;AACD;;AAED,SAAS3G,WAAT,CAAqB+G,IAArB,EAA2B9D,UAA3B,EAAuC+D,kBAAvC,EAA2D;AACzD,MAAIC,iBAAiB,GAAGhE,UAAU,CAACiE,KAAX,GAAmBC,IAAnB,CAAwB,UAAUC,CAAV,EAAaC,CAAb,EAAgB;AAC9D,WAAOA,CAAC,CAAC/D,gBAAF,GAAqB8D,CAAC,CAAC9D,gBAA9B;AACD,GAFuB,CAAxB;AAGA,MAAIgE,SAAS,GAAGP,IAAI,CAACG,KAAL,EAAhB;AACA,MAAIK,cAAc,GAAGN,iBAAiB,CAACL,MAAlB,CAAyB,UAAUY,KAAV,EAAiB;AAC7D,QAAInF,MAAM,GAAGmF,KAAK,CAACpF,MAAN,CAAaC,MAA1B;AAAA,QACIkB,SAAS,GAAGiE,KAAK,CAACjE,SADtB;AAEA,WAAOhB,eAAe,CAACF,MAAD,CAAf,IAA2BkB,SAAlC;AACD,GAJoB,CAArB,CALyD,CASrD;;AAEJ,MAAI,CAACgE,cAAc,CAACT,MAApB,EAA4B;AAC1B,WAAOQ,SAAP;AACD;;AAED,SAAOA,SAAS,CAACH,IAAV,CAAe,UAAUM,OAAV,EAAmBC,OAAnB,EAA4B;AAChD,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGJ,cAAc,CAACT,MAAnC,EAA2Ca,CAAC,IAAI,CAAhD,EAAmD;AACjD,UAAIjD,WAAW,GAAG6C,cAAc,CAACI,CAAD,CAAhC;AACA,UAAItF,MAAM,GAAGqC,WAAW,CAACtC,MAAZ,CAAmBC,MAAhC;AAAA,UACIkB,SAAS,GAAGmB,WAAW,CAACnB,SAD5B;AAEA,UAAIqE,SAAS,GAAGrF,eAAe,CAACF,MAAD,CAA/B;;AAEA,UAAIuF,SAAS,IAAIrE,SAAjB,EAA4B;AAC1B,YAAIsE,aAAa,GAAGD,SAAS,CAACH,OAAD,EAAUC,OAAV,EAAmBnE,SAAnB,CAA7B;;AAEA,YAAIsE,aAAa,KAAK,CAAtB,EAAyB;AACvB,iBAAOtE,SAAS,KAAKtB,MAAd,GAAuB4F,aAAvB,GAAuC,CAACA,aAA/C;AACD;AACF;AACF;;AAED,WAAO,CAAP;AACD,GAjBM,EAiBJxD,GAjBI,CAiBA,UAAUyD,MAAV,EAAkB;AACvB,QAAIC,UAAU,GAAGD,MAAM,CAACd,kBAAD,CAAvB;;AAEA,QAAIe,UAAJ,EAAgB;AACd,aAAO,CAAC,GAAG3H,SAAS,CAAC,SAAD,CAAb,EAA0B,CAAC,GAAGA,SAAS,CAAC,SAAD,CAAb,EAA0B,EAA1B,EAA8B0H,MAA9B,CAA1B,EAAiE,CAAC,GAAG3H,gBAAgB,CAAC,SAAD,CAApB,EAAiC,EAAjC,EAAqC6G,kBAArC,EAAyDhH,WAAW,CAAC+H,UAAD,EAAa9E,UAAb,EAAyB+D,kBAAzB,CAApE,CAAjE,CAAP;AACD;;AAED,WAAOc,MAAP;AACD,GAzBM,CAAP;AA0BD;;AAED,SAAS7H,eAAT,CAAyB+H,KAAzB,EAAgC;AAC9B,MAAIjE,SAAS,GAAGiE,KAAK,CAACjE,SAAtB;AAAA,MACIkE,aAAa,GAAGD,KAAK,CAACC,aAD1B;AAAA,MAEIC,cAAc,GAAGF,KAAK,CAACE,cAF3B;AAAA,MAGIxF,cAAc,GAAGsF,KAAK,CAACtF,cAH3B;AAAA,MAIIyB,WAAW,GAAG6D,KAAK,CAAC7D,WAJxB;AAAA,MAKII,iBAAiB,GAAGyD,KAAK,CAACzD,iBAL9B;;AAOA,MAAI4D,eAAe,GAAG5H,KAAK,CAAC6H,QAAN,CAAevF,iBAAiB,CAACoF,aAAD,EAAgB,IAAhB,CAAhC,CAAtB;AAAA,MACII,gBAAgB,GAAG,CAAC,GAAGnI,eAAe,CAAC,SAAD,CAAnB,EAAgCiI,eAAhC,EAAiD,CAAjD,CADvB;AAAA,MAEIlF,UAAU,GAAGoF,gBAAgB,CAAC,CAAD,CAFjC;AAAA,MAGIC,aAAa,GAAGD,gBAAgB,CAAC,CAAD,CAHpC;;AAKA,MAAIE,kBAAkB,GAAGhI,KAAK,CAACiI,OAAN,CAAc,YAAY;AACjD,QAAIC,QAAQ,GAAG,IAAf;AACA,QAAIC,eAAe,GAAG7F,iBAAiB,CAACoF,aAAD,EAAgB,KAAhB,CAAvC,CAFiD,CAEc;;AAE/D,QAAI,CAACS,eAAe,CAAC5B,MAArB,EAA6B;AAC3B,aAAO7D,UAAP;AACD;;AAED,QAAI0F,cAAc,GAAG,EAArB;;AAEA,aAASC,WAAT,CAAqBC,KAArB,EAA4B;AAC1B,UAAIJ,QAAJ,EAAc;AACZE,QAAAA,cAAc,CAACvF,IAAf,CAAoByF,KAApB;AACD,OAFD,MAEO;AACLF,QAAAA,cAAc,CAACvF,IAAf,CAAoB,CAAC,GAAGhD,SAAS,CAAC,SAAD,CAAb,EAA0B,CAAC,GAAGA,SAAS,CAAC,SAAD,CAAb,EAA0B,EAA1B,EAA8ByI,KAA9B,CAA1B,EAAgE;AAClFtF,UAAAA,SAAS,EAAE;AADuE,SAAhE,CAApB;AAGD;AACF;;AAED,QAAIuF,YAAY,GAAG,IAAnB;AACAJ,IAAAA,eAAe,CAAClF,OAAhB,CAAwB,UAAUqF,KAAV,EAAiB;AACvC,UAAIC,YAAY,KAAK,IAArB,EAA2B;AACzBF,QAAAA,WAAW,CAACC,KAAD,CAAX;;AAEA,YAAIA,KAAK,CAACtF,SAAV,EAAqB;AACnB,cAAIsF,KAAK,CAACvF,gBAAN,KAA2B,KAA/B,EAAsC;AACpCmF,YAAAA,QAAQ,GAAG,KAAX;AACD,WAFD,MAEO;AACLK,YAAAA,YAAY,GAAG,IAAf;AACD;AACF;AACF,OAVD,MAUO,IAAIA,YAAY,IAAID,KAAK,CAACvF,gBAAN,KAA2B,KAA/C,EAAsD;AAC3DsF,QAAAA,WAAW,CAACC,KAAD,CAAX;AACD,OAFM,MAEA;AACLJ,QAAAA,QAAQ,GAAG,KAAX;AACAG,QAAAA,WAAW,CAACC,KAAD,CAAX;AACD;AACF,KAjBD;AAkBA,WAAOF,cAAP;AACD,GAxCwB,EAwCtB,CAACV,aAAD,EAAgBhF,UAAhB,CAxCsB,CAAzB,CAb8B,CAqDG;;AAEjC,MAAI8F,sBAAsB,GAAGxI,KAAK,CAACiI,OAAN,CAAc,YAAY;AACrD,QAAIQ,WAAW,GAAGT,kBAAkB,CAAClE,GAAnB,CAAuB,UAAU4E,KAAV,EAAiB;AACxD,UAAI7G,MAAM,GAAG6G,KAAK,CAAC7G,MAAnB;AAAA,UACImB,SAAS,GAAG0F,KAAK,CAAC1F,SADtB;AAEA,aAAO;AACLnB,QAAAA,MAAM,EAAEA,MADH;AAELmE,QAAAA,KAAK,EAAEhD;AAFF,OAAP;AAID,KAPiB,CAAlB;AAQA,WAAO;AACLyF,MAAAA,WAAW,EAAEA,WADR;AAEL;AACAE,MAAAA,UAAU,EAAEF,WAAW,CAAC,CAAD,CAAX,IAAkBA,WAAW,CAAC,CAAD,CAAX,CAAe5G,MAHxC;AAILmB,MAAAA,SAAS,EAAEyF,WAAW,CAAC,CAAD,CAAX,IAAkBA,WAAW,CAAC,CAAD,CAAX,CAAezC;AAJvC,KAAP;AAMD,GAf4B,EAe1B,CAACgC,kBAAD,CAf0B,CAA7B;;AAiBA,WAAStE,aAAT,CAAuBkF,SAAvB,EAAkC;AAChC,QAAIC,eAAJ;;AAEA,QAAID,SAAS,CAAC7F,gBAAV,KAA+B,KAA/B,IAAwC,CAACiF,kBAAkB,CAACzB,MAA5D,IAAsEyB,kBAAkB,CAAC,CAAD,CAAlB,CAAsBjF,gBAAtB,KAA2C,KAArH,EAA4H;AAC1H8F,MAAAA,eAAe,GAAG,CAACD,SAAD,CAAlB;AACD,KAFD,MAEO;AACLC,MAAAA,eAAe,GAAG,GAAGxF,MAAH,CAAU,CAAC,GAAGvD,mBAAmB,CAAC,SAAD,CAAvB,EAAoCkI,kBAAkB,CAAC3B,MAAnB,CAA0B,UAAUyC,KAAV,EAAiB;AACzG,YAAI1H,GAAG,GAAG0H,KAAK,CAAC1H,GAAhB;AACA,eAAOA,GAAG,KAAKwH,SAAS,CAACxH,GAAzB;AACD,OAH+D,CAApC,CAAV,EAGb,CAACwH,SAAD,CAHa,CAAlB;AAID;;AAEDb,IAAAA,aAAa,CAACc,eAAD,CAAb;AACAlB,IAAAA,cAAc,CAACxB,kBAAkB,CAAC0C,eAAD,CAAnB,EAAsCA,eAAtC,CAAd;AACD;;AAED,MAAIE,gBAAgB,GAAG,SAASA,gBAAT,CAA0BC,YAA1B,EAAwC;AAC7D,WAAOzF,YAAY,CAACC,SAAD,EAAYwF,YAAZ,EAA0BhB,kBAA1B,EAA8CtE,aAA9C,EAA6DvB,cAA7D,EAA6EyB,WAA7E,EAA0FI,iBAA1F,CAAnB;AACD,GAFD;;AAIA,MAAIiF,UAAU,GAAG,SAASA,UAAT,GAAsB;AACrC,WAAO9C,kBAAkB,CAAC6B,kBAAD,CAAzB;AACD,GAFD;;AAIA,SAAO,CAACe,gBAAD,EAAmBf,kBAAnB,EAAuCQ,sBAAvC,EAA+DS,UAA/D,CAAP;AACD","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _typeof3 = require(\"@babel/runtime/helpers/typeof\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getSortData = getSortData;\nexports[\"default\"] = useFilterSorter;\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _extends3 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _typeof2 = _interopRequireDefault(require(\"@babel/runtime/helpers/typeof\"));\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _classnames = _interopRequireDefault(require(\"classnames\"));\n\nvar _CaretDownOutlined = _interopRequireDefault(require(\"@ant-design/icons/CaretDownOutlined\"));\n\nvar _CaretUpOutlined = _interopRequireDefault(require(\"@ant-design/icons/CaretUpOutlined\"));\n\nvar _tooltip = _interopRequireDefault(require(\"../../tooltip\"));\n\nvar _util = require(\"../util\");\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof3(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nvar ASCEND = 'ascend';\nvar DESCEND = 'descend';\n\nfunction getMultiplePriority(column) {\n  if ((0, _typeof2[\"default\"])(column.sorter) === 'object' && typeof column.sorter.multiple === 'number') {\n    return column.sorter.multiple;\n  }\n\n  return false;\n}\n\nfunction getSortFunction(sorter) {\n  if (typeof sorter === 'function') {\n    return sorter;\n  }\n\n  if (sorter && (0, _typeof2[\"default\"])(sorter) === 'object' && sorter.compare) {\n    return sorter.compare;\n  }\n\n  return false;\n}\n\nfunction nextSortDirection(sortDirections, current) {\n  if (!current) {\n    return sortDirections[0];\n  }\n\n  return sortDirections[sortDirections.indexOf(current) + 1];\n}\n\nfunction collectSortStates(columns, init, pos) {\n  var sortStates = [];\n\n  function pushState(column, columnPos) {\n    sortStates.push({\n      column: column,\n      key: (0, _util.getColumnKey)(column, columnPos),\n      multiplePriority: getMultiplePriority(column),\n      sortOrder: column.sortOrder\n    });\n  }\n\n  (columns || []).forEach(function (column, index) {\n    var columnPos = (0, _util.getColumnPos)(index, pos);\n\n    if (column.children) {\n      if ('sortOrder' in column) {\n        // Controlled\n        pushState(column, columnPos);\n      }\n\n      sortStates = [].concat((0, _toConsumableArray2[\"default\"])(sortStates), (0, _toConsumableArray2[\"default\"])(collectSortStates(column.children, init, columnPos)));\n    } else if (column.sorter) {\n      if ('sortOrder' in column) {\n        // Controlled\n        pushState(column, columnPos);\n      } else if (init && column.defaultSortOrder) {\n        // Default sorter\n        sortStates.push({\n          column: column,\n          key: (0, _util.getColumnKey)(column, columnPos),\n          multiplePriority: getMultiplePriority(column),\n          sortOrder: column.defaultSortOrder\n        });\n      }\n    }\n  });\n  return sortStates;\n}\n\nfunction injectSorter(prefixCls, columns, sorterSates, triggerSorter, defaultSortDirections, tableLocale, tableShowSorterTooltip, pos) {\n  return (columns || []).map(function (column, index) {\n    var columnPos = (0, _util.getColumnPos)(index, pos);\n    var newColumn = column;\n\n    if (newColumn.sorter) {\n      var sortDirections = newColumn.sortDirections || defaultSortDirections;\n      var showSorterTooltip = newColumn.showSorterTooltip === undefined ? tableShowSorterTooltip : newColumn.showSorterTooltip;\n      var columnKey = (0, _util.getColumnKey)(newColumn, columnPos);\n      var sorterState = sorterSates.find(function (_ref) {\n        var key = _ref.key;\n        return key === columnKey;\n      });\n      var sorterOrder = sorterState ? sorterState.sortOrder : null;\n      var nextSortOrder = nextSortDirection(sortDirections, sorterOrder);\n      var upNode = sortDirections.includes(ASCEND) && /*#__PURE__*/React.createElement(_CaretUpOutlined[\"default\"], {\n        className: (0, _classnames[\"default\"])(\"\".concat(prefixCls, \"-column-sorter-up\"), {\n          active: sorterOrder === ASCEND\n        })\n      });\n      var downNode = sortDirections.includes(DESCEND) && /*#__PURE__*/React.createElement(_CaretDownOutlined[\"default\"], {\n        className: (0, _classnames[\"default\"])(\"\".concat(prefixCls, \"-column-sorter-down\"), {\n          active: sorterOrder === DESCEND\n        })\n      });\n\n      var _ref2 = tableLocale || {},\n          cancelSort = _ref2.cancelSort,\n          triggerAsc = _ref2.triggerAsc,\n          triggerDesc = _ref2.triggerDesc;\n\n      var sortTip = cancelSort;\n\n      if (nextSortOrder === DESCEND) {\n        sortTip = triggerDesc;\n      } else if (nextSortOrder === ASCEND) {\n        sortTip = triggerAsc;\n      }\n\n      var tooltipProps = (0, _typeof2[\"default\"])(showSorterTooltip) === 'object' ? showSorterTooltip : {\n        title: sortTip\n      };\n      newColumn = (0, _extends3[\"default\"])((0, _extends3[\"default\"])({}, newColumn), {\n        className: (0, _classnames[\"default\"])(newColumn.className, (0, _defineProperty2[\"default\"])({}, \"\".concat(prefixCls, \"-column-sort\"), sorterOrder)),\n        title: function title(renderProps) {\n          var renderSortTitle = /*#__PURE__*/React.createElement(\"div\", {\n            className: \"\".concat(prefixCls, \"-column-sorters\")\n          }, /*#__PURE__*/React.createElement(\"span\", null, (0, _util.renderColumnTitle)(column.title, renderProps)), /*#__PURE__*/React.createElement(\"span\", {\n            className: (0, _classnames[\"default\"])(\"\".concat(prefixCls, \"-column-sorter\"), (0, _defineProperty2[\"default\"])({}, \"\".concat(prefixCls, \"-column-sorter-full\"), !!(upNode && downNode)))\n          }, /*#__PURE__*/React.createElement(\"span\", {\n            className: \"\".concat(prefixCls, \"-column-sorter-inner\")\n          }, upNode, downNode)));\n          return showSorterTooltip ? /*#__PURE__*/React.createElement(_tooltip[\"default\"], tooltipProps, /*#__PURE__*/React.createElement(\"div\", {\n            className: \"\".concat(prefixCls, \"-column-sorters-with-tooltip\")\n          }, renderSortTitle)) : renderSortTitle;\n        },\n        onHeaderCell: function onHeaderCell(col) {\n          var cell = column.onHeaderCell && column.onHeaderCell(col) || {};\n          var originOnClick = cell.onClick;\n\n          cell.onClick = function (event) {\n            triggerSorter({\n              column: column,\n              key: columnKey,\n              sortOrder: nextSortOrder,\n              multiplePriority: getMultiplePriority(column)\n            });\n\n            if (originOnClick) {\n              originOnClick(event);\n            }\n          };\n\n          cell.className = (0, _classnames[\"default\"])(cell.className, \"\".concat(prefixCls, \"-column-has-sorters\"));\n          return cell;\n        }\n      });\n    }\n\n    if ('children' in newColumn) {\n      newColumn = (0, _extends3[\"default\"])((0, _extends3[\"default\"])({}, newColumn), {\n        children: injectSorter(prefixCls, newColumn.children, sorterSates, triggerSorter, defaultSortDirections, tableLocale, tableShowSorterTooltip, columnPos)\n      });\n    }\n\n    return newColumn;\n  });\n}\n\nfunction stateToInfo(sorterStates) {\n  var column = sorterStates.column,\n      sortOrder = sorterStates.sortOrder;\n  return {\n    column: column,\n    order: sortOrder,\n    field: column.dataIndex,\n    columnKey: column.key\n  };\n}\n\nfunction generateSorterInfo(sorterStates) {\n  var list = sorterStates.filter(function (_ref3) {\n    var sortOrder = _ref3.sortOrder;\n    return sortOrder;\n  }).map(stateToInfo); // =========== Legacy compatible support ===========\n  // https://github.com/ant-design/ant-design/pull/19226\n\n  if (list.length === 0 && sorterStates.length) {\n    return (0, _extends3[\"default\"])((0, _extends3[\"default\"])({}, stateToInfo(sorterStates[sorterStates.length - 1])), {\n      column: undefined\n    });\n  }\n\n  if (list.length <= 1) {\n    return list[0] || {};\n  }\n\n  return list;\n}\n\nfunction getSortData(data, sortStates, childrenColumnName) {\n  var innerSorterStates = sortStates.slice().sort(function (a, b) {\n    return b.multiplePriority - a.multiplePriority;\n  });\n  var cloneData = data.slice();\n  var runningSorters = innerSorterStates.filter(function (_ref4) {\n    var sorter = _ref4.column.sorter,\n        sortOrder = _ref4.sortOrder;\n    return getSortFunction(sorter) && sortOrder;\n  }); // Skip if no sorter needed\n\n  if (!runningSorters.length) {\n    return cloneData;\n  }\n\n  return cloneData.sort(function (record1, record2) {\n    for (var i = 0; i < runningSorters.length; i += 1) {\n      var sorterState = runningSorters[i];\n      var sorter = sorterState.column.sorter,\n          sortOrder = sorterState.sortOrder;\n      var compareFn = getSortFunction(sorter);\n\n      if (compareFn && sortOrder) {\n        var compareResult = compareFn(record1, record2, sortOrder);\n\n        if (compareResult !== 0) {\n          return sortOrder === ASCEND ? compareResult : -compareResult;\n        }\n      }\n    }\n\n    return 0;\n  }).map(function (record) {\n    var subRecords = record[childrenColumnName];\n\n    if (subRecords) {\n      return (0, _extends3[\"default\"])((0, _extends3[\"default\"])({}, record), (0, _defineProperty2[\"default\"])({}, childrenColumnName, getSortData(subRecords, sortStates, childrenColumnName)));\n    }\n\n    return record;\n  });\n}\n\nfunction useFilterSorter(_ref5) {\n  var prefixCls = _ref5.prefixCls,\n      mergedColumns = _ref5.mergedColumns,\n      onSorterChange = _ref5.onSorterChange,\n      sortDirections = _ref5.sortDirections,\n      tableLocale = _ref5.tableLocale,\n      showSorterTooltip = _ref5.showSorterTooltip;\n\n  var _React$useState = React.useState(collectSortStates(mergedColumns, true)),\n      _React$useState2 = (0, _slicedToArray2[\"default\"])(_React$useState, 2),\n      sortStates = _React$useState2[0],\n      setSortStates = _React$useState2[1];\n\n  var mergedSorterStates = React.useMemo(function () {\n    var validate = true;\n    var collectedStates = collectSortStates(mergedColumns, false); // Return if not controlled\n\n    if (!collectedStates.length) {\n      return sortStates;\n    }\n\n    var validateStates = [];\n\n    function patchStates(state) {\n      if (validate) {\n        validateStates.push(state);\n      } else {\n        validateStates.push((0, _extends3[\"default\"])((0, _extends3[\"default\"])({}, state), {\n          sortOrder: null\n        }));\n      }\n    }\n\n    var multipleMode = null;\n    collectedStates.forEach(function (state) {\n      if (multipleMode === null) {\n        patchStates(state);\n\n        if (state.sortOrder) {\n          if (state.multiplePriority === false) {\n            validate = false;\n          } else {\n            multipleMode = true;\n          }\n        }\n      } else if (multipleMode && state.multiplePriority !== false) {\n        patchStates(state);\n      } else {\n        validate = false;\n        patchStates(state);\n      }\n    });\n    return validateStates;\n  }, [mergedColumns, sortStates]); // Get render columns title required props\n\n  var columnTitleSorterProps = React.useMemo(function () {\n    var sortColumns = mergedSorterStates.map(function (_ref6) {\n      var column = _ref6.column,\n          sortOrder = _ref6.sortOrder;\n      return {\n        column: column,\n        order: sortOrder\n      };\n    });\n    return {\n      sortColumns: sortColumns,\n      // Legacy\n      sortColumn: sortColumns[0] && sortColumns[0].column,\n      sortOrder: sortColumns[0] && sortColumns[0].order\n    };\n  }, [mergedSorterStates]);\n\n  function triggerSorter(sortState) {\n    var newSorterStates;\n\n    if (sortState.multiplePriority === false || !mergedSorterStates.length || mergedSorterStates[0].multiplePriority === false) {\n      newSorterStates = [sortState];\n    } else {\n      newSorterStates = [].concat((0, _toConsumableArray2[\"default\"])(mergedSorterStates.filter(function (_ref7) {\n        var key = _ref7.key;\n        return key !== sortState.key;\n      })), [sortState]);\n    }\n\n    setSortStates(newSorterStates);\n    onSorterChange(generateSorterInfo(newSorterStates), newSorterStates);\n  }\n\n  var transformColumns = function transformColumns(innerColumns) {\n    return injectSorter(prefixCls, innerColumns, mergedSorterStates, triggerSorter, sortDirections, tableLocale, showSorterTooltip);\n  };\n\n  var getSorters = function getSorters() {\n    return generateSorterInfo(mergedSorterStates);\n  };\n\n  return [transformColumns, mergedSorterStates, columnTitleSorterProps, getSorters];\n}"]},"metadata":{},"sourceType":"script"}